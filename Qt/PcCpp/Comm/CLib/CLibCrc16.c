/******************************************************************************
 *
 * 文件名  ： CLibCrc16.c
 * 创建日期： 20190425 
 * 版本号  ： v1.0
 * 文件描述： Crc16算法实现
 * 其    他： 二项式使用 0x8005
 * 修改日志： 无
 *
  *******************************************************************************/


/*---------------------------------- 预处理区 ---------------------------------*/

/************************************ 头文件 ***********************************/
#include "CLibCrc16.h"

#define _CLIB_CRC16_CODE_                   (0x8005)

/*----------------------------------- 声明区 ----------------------------------*/

/********************************** 变量声明区 *********************************/


/********************************** 函数声明区 *********************************/


/********************************** 变量实现区 *********************************/


/********************************** 函数实现区 *********************************/
void CLibCrc16(const u8 *data, u8 length, u16 *crc16)
{
    i32 counter;
    u16 crc = 0;
    u8  shiftReg;
    u8  dataBit;
    u8  crcBit;

    for (counter = 0; counter < length; counter++)
    {
        for (shiftReg = 0x01; shiftReg > 0x00; shiftReg <<= 1)
        {
            dataBit = (data[counter] & shiftReg) ? 1 : 0;
            crcBit = crc >> 15;
            crc <<= 1;
            if (dataBit != crcBit)
            {
                crc ^= _CLIB_CRC16_CODE_;
            }
        }
    }
    
    *crc16 = crc;
}
