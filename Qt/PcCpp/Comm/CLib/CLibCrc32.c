/******************************************************************************
 *
 * 文件名  ： CLibCrc32.c
 * 创建日期： 20190524 
 * 版本号  ： v1.0
 * 文件描述： Crc32算法实现(与STM32硬件模块一致)
 * 其    他： 二项式使用 0x4C11DB7
 * 修改日志： 无
 *
  *******************************************************************************/


/*---------------------------------- 预处理区 ---------------------------------*/

/************************************ 头文件 ***********************************/
#include "CLibCrc32.h"

#define _CRC32_CODE_                    (0x4C11DB7)
#define _U32_MSB_HIGH_                  (0x80000000)

/*----------------------------------- 声明区 ----------------------------------*/

/********************************** 变量声明区 *********************************/


/********************************** 函数声明区 *********************************/


/********************************** 变量实现区 *********************************/


/********************************** 函数实现区 *********************************/
void CLibCrc32(const u32 *data, u32 len, u32 *crc32)
{
    u32 i = 0;
    i32 j = 0;
    u32 xBit = 0;
    u32 crc = 0xFFFFFFFF;
    u32 aData = 0;

    for(i = 0; i < len; i++)
    {
        aData = data[i];
        xBit = _U32_MSB_HIGH_;
        for(j = 0; j < 32; j++)
        {
            if( _U32_MSB_HIGH_ & crc)
            {
                crc <<= 1;
                crc ^= _CRC32_CODE_;
            }
            else
            {
                crc <<= 1;
            }
    
            if(aData & xBit)
            {
                crc ^= _CRC32_CODE_;
            }
    
            xBit >>= 1;
        }
    
    }
    
    *crc32 = crc;
    
    return;
}
